"0","driver_standings = read.csv(""data/Driver_Rankings.csv"")"
"0","# champions per season"
"0","champions_per_year <- merge("
"0","  merge(driver_standings, race_info[, c(""raceId"", ""year"")]),"
"0","  drivers[, c(""driverId"", ""surname"")]"
"0",")"
"0",""
"0","champions_per_year <- champions_per_year["
"0","  champions_per_year$position == 1, ]"
"0",""
"0","# take only the final race of the season"
"0","champions_per_year <- champions_per_year[ave("
"0","  champions_per_year$raceId,"
"0","  champions_per_year$year,"
"0","  FUN = max) == champions_per_year$raceId,"
"0","  c(""year"", ""surname"")"
"0","]"
"0",""
"0","# now filter & aggregate"
"0","tmp <- merge(world_champs_races, champions_per_year,"
"0","             by = c(""year"", ""surname""))"
"0",""
"0","wins_df  <- aggregate(positionOrder ~ year + surname, tmp,"
"0","                      function(x) sum(x == 1))"
"0","races_df <- aggregate(raceId        ~ year + surname, tmp,"
"0","                      function(x) length(unique(x)))"
"0","names(wins_df)[3]  <- ""wins"""
"0","names(races_df)[3] <- ""races"""
"0",""
"0","champ_wins_year <- merge(wins_df, races_df, by = c(""year"", ""surname""))"
"0","champ_wins_year$win_rate <- with(champ_wins_year, wins / races)"
"0","champ_wins_year <- champ_wins_year[order(champ_wins_year$year), ]"
"0",""
"0","champ_wins_year"
